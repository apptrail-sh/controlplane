spring:
  application:
    name: controlplane
  datasource:
    driver-class-name: org.postgresql.Driver
    url: jdbc:postgresql://localhost:5432/apptrail
    username: apptrail
    password: apptrail
  docker:
    compose:
      lifecycle-management: start-only
  cloud:
    gcp:
      pubsub:
        enabled: ${PUBSUB_ENABLED:false}

app:
  clusters:
    # Unified cluster definitions
    # Example configuration:
    # definitions:
    #   cluster-staging-gke-usce1:
    #     environment: staging
    #     alias: stg.01
    #     shard:
    #       name: canary
    #       order: 0
    #     namespaces:  # Optional namespace-level shard overrides
    #       special-ns:
    #         shard:
    #           name: shard02
    #           order: 2
    definitions: {}
    environments:
      - name: dev
        order: 0
      - name: staging
        order: 1
      - name: production
        order: 2
  ingest:
    http:
      enabled: true
    pubsub:
      enabled: ${PUBSUB_ENABLED:false}
      subscription: ${PUBSUB_SUBSCRIPTION:}
    team-label: team
  gitprovider:
    github:
      enabled: ${GITHUB_APP_ENABLED:false}
      app-id: ${GITHUB_APP_ID:}
      private-key-path: ${GITHUB_APP_PRIVATE_KEY_PATH:}
      private-key-base64: ${GITHUB_APP_PRIVATE_KEY_BASE64:}
      api-base-url: ${GITHUB_API_BASE_URL:https://api.github.com}
  release-fetch:
    enabled: true
    interval-ms: ${RELEASE_FETCH_INTERVAL_MS:30000}
  cors:
    allowed-origins:
      - "http://localhost:5173"
      - "http://localhost:3000"
    allowed-methods:
      - "GET"
      - "POST"
      - "PUT"
      - "PATCH"
      - "DELETE"
      - "OPTIONS"
    allowed-headers:
      - "*"
    allow-credentials: false
    max-age: 3600
  alerting:
    prometheus:
      enabled: ${PROMETHEUS_ENABLED:false}
      base-url: ${PROMETHEUS_BASE_URL:http://localhost:8481}
      query-path: ${PROMETHEUS_QUERY_PATH:/select/0:0/prometheus/api/v1/query}
      timeout-ms: ${PROMETHEUS_TIMEOUT_MS:5000}
      cache:
        enabled: true
        ttl-seconds: 30

server:
  port: 3000
